<!DOCTYPE html>
<html>
  <head>
    <title>Bluetooth Data Transfer</title>
  </head>
  <body>
    <button id="connect-btn">Connect and Send Data</button>

    <script>
      document.getElementById('connect-btn').addEventListener('click', async () => {
        try {
          // 请求连接到蓝牙设备
          const device = await navigator.bluetooth.requestDevice({
            filters: [{ services: ['0000ffee-0000-1000-8000-00805f9b34fb'] }], // 替换为设备的服务 UUID
            optionalServices: ['0000ffee-0000-1000-8000-00805f9b34fb']
          });

          console.log('Device selected:', device.name);

          // 连接到 GATT 服务器
          const server = await device.gatt.connect();
          console.log('Connected to GATT server');

          // 获取蓝牙服务
          const service = await server.getPrimaryService('0000ffee-0000-1000-8000-00805f9b34fb'); // 替换为服务 UUID
          console.log('Service retrieved');

          // 获取特征值
          const characteristic = await service.getCharacteristic('0000ffe1-0000-1000-8000-00805f9b34fb'); // 替换为特征 UUID
          console.log('Characteristic retrieved');

          // 准备发送数据
          const encoder = new TextEncoder();
          const data = encoder.encode('Hello from Web Bluetooth!'); // 你要发送的文本内容

          // 写入数据到特征值
          await characteristic.writeValue(data);
          console.log('Data sent successfully!');

        } catch (error) {
          console.error('Error:', error);
        }
      });
    </script>
  </body>
</html>
